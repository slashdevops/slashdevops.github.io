<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Using Files as a Flag in the Golang Command Line Interface (CLI) | SlashDevOps</title>
<meta name=keywords content="golang,cli,flag,file,go"><meta name=description content="Introduction In this post, we will see how to use files as a flag in the Golang Command Line Interface (CLI). This is useful when you want to pass a file (not the file name, but an object of file type) as a flag to your CLI application.
Use the file name as a flag is straightforward, you can use the flag.String or flag.StringVar function to get the file name and then do the necessary checks to validate if this exist, create it, clean it, etc."><meta name=author content="Christian González Di Antonio"><link rel=canonical href=https://slashdevops.com/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://slashdevops.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://slashdevops.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://slashdevops.com/favicon-32x32.png><link rel=apple-touch-icon href=https://slashdevops.com/apple-touch-icon.png><link rel=mask-icon href=https://slashdevops.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://slashdevops.com/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZTLZKCCSQ6"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZTLZKCCSQ6",{anonymize_ip:!1})}</script><meta property="og:title" content="Using Files as a Flag in the Golang Command Line Interface (CLI)"><meta property="og:description" content="Introduction In this post, we will see how to use files as a flag in the Golang Command Line Interface (CLI). This is useful when you want to pass a file (not the file name, but an object of file type) as a flag to your CLI application.
Use the file name as a flag is straightforward, you can use the flag.String or flag.StringVar function to get the file name and then do the necessary checks to validate if this exist, create it, clean it, etc."><meta property="og:type" content="article"><meta property="og:url" content="https://slashdevops.com/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/"><meta property="og:image" content="https://slashdevops.com/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/post/2024/04/07/1/images/vscode-flagvar.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-04-07T10:17:23+02:00"><meta property="article:modified_time" content="2024-04-07T10:17:23+02:00"><meta property="og:site_name" content="SlashDevOps"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://slashdevops.com/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/post/2024/04/07/1/images/vscode-flagvar.png"><meta name=twitter:title content="Using Files as a Flag in the Golang Command Line Interface (CLI)"><meta name=twitter:description content="Introduction In this post, we will see how to use files as a flag in the Golang Command Line Interface (CLI). This is useful when you want to pass a file (not the file name, but an object of file type) as a flag to your CLI application.
Use the file name as a flag is straightforward, you can use the flag.String or flag.StringVar function to get the file name and then do the necessary checks to validate if this exist, create it, clean it, etc."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://slashdevops.com/post/"},{"@type":"ListItem","position":2,"name":"Using Files as a Flag in the Golang Command Line Interface (CLI)","item":"https://slashdevops.com/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Using Files as a Flag in the Golang Command Line Interface (CLI)","name":"Using Files as a Flag in the Golang Command Line Interface (CLI)","description":"Introduction In this post, we will see how to use files as a flag in the Golang Command Line Interface (CLI). This is useful when you want to pass a file (not the file name, but an object of file type) as a flag to your CLI application.\nUse the file name as a flag is straightforward, you can use the flag.String or flag.StringVar function to get the file name and then do the necessary checks to validate if this exist, create it, clean it, etc.","keywords":["golang","cli","flag","file","go"],"articleBody":"Introduction In this post, we will see how to use files as a flag in the Golang Command Line Interface (CLI). This is useful when you want to pass a file (not the file name, but an object of file type) as a flag to your CLI application.\nUse the file name as a flag is straightforward, you can use the flag.String or flag.StringVar function to get the file name and then do the necessary checks to validate if this exist, create it, clean it, etc. But, if you want to pass the file as a flag, you need to create a custom flag type that implements the Value interface of the flag package for the struct type that represents the file flag.\nFor impatient 😔, you can check the 👉 GitHub repository -\u003e github.com/slashdevops/go-files-as-a-flag or in the 👉 Implementation section.\nCustom Flag Type To implement a custom flag type for a file flag, you need to create a struct type that represents the file flag you want to create. This struct type must implement the Value interface of the flag package.\nThis interface has the following methods:\n👉 String() string: presents the current value as a string. 👉 Set(string) error: is called once, in command line order, for each flag present. 👉 Get() interface{}: returns the contents of the Value. 👉 IsBoolFlag() bool: returns true if the flag is a boolean flag. So, I created a struct type called FileVar that has a *os.File field to store the file and implemented the Value interface methods.\nI didn’t need to use more fields because the *os.File field is enough for my use case. But, you can add more fields if you need to store more information about the file.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 type FileVar struct { *os.File } func (f *FileVar) String() string { ... (implementation is below) 👇 } func (f *FileVar) Set(value string) error { ... (implementation is below) 👇 } func (f *FileVar) Get() interface{} { ... (implementation is below) 👇 } func (f *FileVar) IsBoolFlag() bool { ... (implementation is below) 👇 } NOTE: check the lines 👉 12, 👉 17, 👉 26, 👉 37, 👉 42 of the Implementation to see how I implemented these methods.\nUsage To use the file flag in your CLI application, you need to create a new flag set using the flag.NewFlagSet function. Then, you can add the file flag using the FlagSet.Var function as is implemented in the Implementation line 👉 48 and 👉 57.\nExample of usage with --help flag:\n1 2 3 4 5 6 go run main.go --help Usage of File as Flag CLI: -file.content string content to write to the file -output.file value output file (default /dev/stdout) NOTE: as you can see, the output.file flag has the default value /dev/stdout. So, if you don’t pass this flag, the output will be written to the stdout, let’s see this in the next example.\nExample of usage with --file.content flag:\n1 2 3 4 go run main.go --file.content 'Hello, World' # and the output will be: Hello, World! Now, let’s see how to use the output.file flag to write the output to a file.\nExample of usage with --file.content and --output.file flags:\n1 2 3 4 5 6 7 8 9 go run main.go \\ -file.content 'Hello, World!' \\ -output.file /tmp/my-output-file.txt # let's check the content of the file cat /tmp/my-output-file.txt # and the output will be: Hello, World! NOTE: as you can see, the output was written to the /tmp/my-output-file.txt file.\nCritical Points For me ☝️ the magic 🪄 of this implementation is in the Set method of the FileVar struct. This method is called once, in command line order, for each flag present. So, in this method, I open the file with the os.OpenFile function and set the *os.File field of the FileVar struct with the file descriptor.\nThe options os.O_APPEND|os.O_CREATE|os.O_WRONLY are used to open the file in write-only mode, create it if it doesn’t exist, and append the content if the file already exists.\nNOTE:, maybe you want to overwrite the file content instead of appending it, you can use the os.O_TRUNC option instead of the os.O_APPEND option.\n1 2 3 4 5 6 7 8 9 func (f *FileVar) Set(value string) error { file, err := os.OpenFile(value, os.O_APPEND|os.O_CREATE|os.O_WRONLY, 0o644) if err != nil { return err } f.File = file return nil } Implementation This code is available in the GitHub repository -\u003e github.com/slashdevops/go-files-as-a-flag.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 package main import ( \"flag\" \"fmt\" \"os\" ) // FileVar is a custom flag type for files // This should implement the Value interface of the flag package // Reference: https://pkg.go.dev/gg-scm.io/tool/internal/flag#FlagSet.Var type FileVar struct { *os.File } // String presents the current value as a string. func (f *FileVar) String() string { if f.File == nil { return \"\" } return f.Name() } // Set is called once, in command line order, for each flag present. func (f *FileVar) Set(value string) error { file, err := os.OpenFile(value, os.O_APPEND|os.O_CREATE|os.O_WRONLY, 0o644) if err != nil { return err } f.File = file return nil } // Get returns the contents of the Value. func (f *FileVar) Get() interface{} { return f.File } // IsBoolFlag returns true if the flag is a boolean flag func (f *FileVar) IsBoolFlag() bool { return false } func main() { // Create a new flag set fs := flag.NewFlagSet(\"File as Flag CLI\", flag.ExitOnError) // Add a flag to get some content var content string fs.StringVar(\u0026content, \"file.content\", \"\", \"content to write to the file\") // Add a custom file flag file := \u0026FileVar{os.Stdout} defer file.Close() fs.Var(file, \"output.file\", \"output file\") // Parse the command line arguments fs.Parse(os.Args[1:]) // Check if the content is empty (required) if content == \"\" { fs.PrintDefaults() fmt.Println(\"error: '-file.content' is required\") os.Exit(1) } // Write the content to the file file.Write([]byte(content)) } Conclusion The flag package of the Golang standard library is powerful and flexible as you saw in this post. You can create custom flag types to extend the functionality of the package and adapt it to your needs. For this you should implement the Value interface of the flag package for the struct type that represents your flag type.\nI hope this post helps you to use files as a flag in your Golang CLI applications. If you have any questions or suggestions, please let me know in the comments below. 🙏\n","wordCount":"1147","inLanguage":"en","image":"https://slashdevops.com/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/post/2024/04/07/1/images/vscode-flagvar.png","datePublished":"2024-04-07T10:17:23+02:00","dateModified":"2024-04-07T10:17:23+02:00","author":{"@type":"Person","name":"Christian González Di Antonio"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://slashdevops.com/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/"},"publisher":{"@type":"Organization","name":"SlashDevOps","logo":{"@type":"ImageObject","url":"https://slashdevops.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://slashdevops.com/ accesskey=h title="slashdevops.com (Alt + H)"><img src=https://slashdevops.com/safari-pinned-tab.svg alt aria-label=logo height=45>slashdevops.com</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://slashdevops.com/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://github.com/slashdevops title=GitHub><span>GitHub</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://slashdevops.com/archives title=Archives><span>Archives</span></a></li><li><a href=https://slashdevops.com/post/ title=Blog><span>Blog</span></a></li><li><a href=https://slashdevops.com/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://slashdevops.com/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://slashdevops.com/>Home</a>&nbsp;»&nbsp;<a href=https://slashdevops.com/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Using Files as a Flag in the Golang Command Line Interface (CLI)</h1><div class=post-meta><span title='2024-04-07 10:17:23 +0200 +0200'>April 7, 2024</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1147 words&nbsp;·&nbsp;Christian González Di Antonio&nbsp;|&nbsp;<a href=https://github.com/slashdevops/slashdevops.github.io/tree/main/content//post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli.md rel="noopener noreferrer" target=_blank>Edit this post on GitHub</a></div></header><figure class=entry-cover><img loading=eager src=https://slashdevops.com/post/2024/04/07/1/images/vscode-flagvar.png alt="Using Files as a Flag in the Golang Command Line Interface (CLI)"><p>Using Files as a Flag in the Golang Command Line Interface (CLI)</p></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#custom-flag-type>Custom Flag Type</a></li><li><a href=#usage>Usage</a></li><li><a href=#critical-points>Critical Points</a></li><li><a href=#implementation>Implementation</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details></div><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>In this post, we will see how to use files as a <a href=https://pkg.go.dev/flag>flag in the Golang</a> <a href=https://en.wikipedia.org/wiki/Command-line_interface>Command Line Interface (CLI)</a>. This is useful when you want to pass a <code>file</code> <strong>(not the file name, but an object of file type)</strong> as a <code>flag</code> to your CLI application.</p><p>Use the <code>file name</code> as a flag is straightforward, you can use the <a href=https://pkg.go.dev/gg-scm.io/tool/internal/flag#FlagSet.String>flag.String</a> or <a href=https://pkg.go.dev/gg-scm.io/tool/internal/flag#FlagSet.StringVar>flag.StringVar</a> function to get the <code>file name</code> and then do the necessary checks to validate if this exist, create it, clean it, etc. But, if you want to pass the <code>file</code> as a flag, you need to create a <strong>custom flag type</strong> that implements the <a href=https://pkg.go.dev/gg-scm.io/tool/internal/flag#Value>Value interface</a> of the <a href=https://pkg.go.dev/gg-scm.io/tool/internal/flag>flag package</a> for the <code>struct type</code> that represents the <code>file flag</code>.</p><p><strong>For impatient</strong> 😔, you can check the 👉 <a href=https://github.com/slashdevops/go-files-as-a-flag/blob/main/main.go>GitHub repository -> github.com/slashdevops/go-files-as-a-flag</a> or in the 👉 <a href=/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/#implementation>Implementation</a> section.</p><h2 id=custom-flag-type>Custom Flag Type<a hidden class=anchor aria-hidden=true href=#custom-flag-type>#</a></h2><p>To implement a <code>custom flag type</code> for a <code>file flag</code>, you need to create a <code>struct type</code> that represents the <code>file flag</code> you want to create. This <code>struct type</code> must implement the <a href=https://pkg.go.dev/gg-scm.io/tool/internal/flag#Value>Value interface</a> of the <a href=https://pkg.go.dev/gg-scm.io/tool/internal/flag>flag package</a>.</p><p>This <a href=https://pkg.go.dev/gg-scm.io/tool/internal/flag#Value>interface</a> has the following methods:</p><ul><li>👉 <code>String() string</code>: presents the current value as a string.</li><li>👉 <code>Set(string) error</code>: is called once, in command line order, for each flag present.</li><li>👉 <code>Get() interface{}</code>: returns the contents of the Value.</li><li>👉 <code>IsBoolFlag() bool</code>: returns true if the flag is a boolean flag.</li></ul><p>So, I created a <a href=/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/#hl-0-1>struct type called FileVar</a> that has a <code>*os.File</code> field to store the <code>file</code> and implemented the <a href=https://pkg.go.dev/gg-scm.io/tool/internal/flag#Value>Value interface</a> methods.</p><p>I didn&rsquo;t need to use more fields because the <code>*os.File</code> field is enough for my use case. But, you can add more fields if you need to store more information about the <code>file</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>FileVar</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span><span class=nx>os</span><span class=p>.</span><span class=nx>File</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>f</span> <span class=o>*</span><span class=nx>FileVar</span><span class=p>)</span> <span class=nf>String</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span> <span class=p>(</span><span class=nx>implementation</span> <span class=nx>is</span> <span class=nx>below</span><span class=p>)</span> <span class=err>👇</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>f</span> <span class=o>*</span><span class=nx>FileVar</span><span class=p>)</span> <span class=nf>Set</span><span class=p>(</span><span class=nx>value</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span> <span class=p>(</span><span class=nx>implementation</span> <span class=nx>is</span> <span class=nx>below</span><span class=p>)</span> <span class=err>👇</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>f</span> <span class=o>*</span><span class=nx>FileVar</span><span class=p>)</span> <span class=nf>Get</span><span class=p>()</span> <span class=kd>interface</span><span class=p>{}</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span> <span class=p>(</span><span class=nx>implementation</span> <span class=nx>is</span> <span class=nx>below</span><span class=p>)</span> <span class=err>👇</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>f</span> <span class=o>*</span><span class=nx>FileVar</span><span class=p>)</span> <span class=nf>IsBoolFlag</span><span class=p>()</span> <span class=kt>bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span> <span class=p>(</span><span class=nx>implementation</span> <span class=nx>is</span> <span class=nx>below</span><span class=p>)</span> <span class=err>👇</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>NOTE:</strong> check the lines 👉 <a href=/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/#hl-1-12>12</a>,
👉 <a href=/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/#hl-1-17>17</a>,
👉 <a href=/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/#hl-1-26>26</a>,
👉 <a href=/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/#hl-1-37>37</a>,
👉 <a href=/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/#hl-1-42>42</a> of the <a href=/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/#implementation>Implementation</a> to see how I implemented these methods.</p><h2 id=usage>Usage<a hidden class=anchor aria-hidden=true href=#usage>#</a></h2><p>To use the <code>file flag</code> in your CLI application, you need to create a new <code>flag set</code> using the <a href=https://pkg.go.dev/gg-scm.io/tool/internal/flag#NewFlagSet>flag.NewFlagSet</a> function. Then, you can add the <code>file flag</code> using the <a href=https://pkg.go.dev/gg-scm.io/tool/internal/flag#FlagSet.Var>FlagSet.Var</a> function as is implemented in the <a href=/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/#implementation>Implementation</a> line 👉 <a href=/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/#hl-1-48>48</a> and 👉 <a href=/post/2024/04/07/1/using-files-as-a-flag-in-the-golang-command-line-interface-cli/#hl-1-57>57</a>.</p><p>Example of usage with <code>--help</code> flag:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5>5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=k>go</span> <span class=nx>run</span> <span class=nx>main</span><span class=p>.</span><span class=k>go</span> <span class=o>--</span><span class=nx>help</span>
</span></span><span class=line><span class=cl><span class=nx>Usage</span> <span class=nx>of</span> <span class=nx>File</span> <span class=nx>as</span> <span class=nx>Flag</span> <span class=nx>CLI</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=nx>file</span><span class=p>.</span><span class=nx>content</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>        <span class=nx>content</span> <span class=nx>to</span> <span class=nx>write</span> <span class=nx>to</span> <span class=nx>the</span> <span class=nx>file</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=nx>output</span><span class=p>.</span><span class=nx>file</span> <span class=nx>value</span>
</span></span><span class=line><span class=cl>        <span class=nx>output</span> <span class=nf>file</span> <span class=p>(</span><span class=k>default</span> <span class=o>/</span><span class=nx>dev</span><span class=o>/</span><span class=nx>stdout</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>NOTE:</strong> as you can see, the <code>output.file</code> flag has the <code>default</code> value <code>/dev/stdout</code>. So, if you don&rsquo;t pass this flag, the output will be written to the <code>stdout</code>, let&rsquo;s see this in the next example.</p><p>Example of usage with <code>--file.content</code> flag:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3>3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=k>go</span> <span class=nx>run</span> <span class=nx>main</span><span class=p>.</span><span class=k>go</span> <span class=o>--</span><span class=nx>file</span><span class=p>.</span><span class=nx>content</span> <span class=err>&#39;</span><span class=nx>Hello</span><span class=p>,</span> <span class=nx>World</span><span class=err>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>and</span> <span class=nx>the</span> <span class=nx>output</span> <span class=nx>will</span> <span class=nx>be</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=nx>Hello</span><span class=p>,</span> <span class=nx>World</span><span class=p>!</span>
</span></span></code></pre></td></tr></table></div></div><p>Now, let&rsquo;s see how to use the <code>output.file</code> flag to write the output to a file.</p><p>Example of usage with <code>--file.content</code> and <code>--output.file</code> flags:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4>4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5>5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6>6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7>7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8>8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=k>go</span> <span class=nx>run</span> <span class=nx>main</span><span class=p>.</span><span class=k>go</span> \
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=nx>file</span><span class=p>.</span><span class=nx>content</span> <span class=err>&#39;</span><span class=nx>Hello</span><span class=p>,</span> <span class=nx>World</span><span class=p>!</span><span class=err>&#39;</span> \
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=nx>output</span><span class=p>.</span><span class=nx>file</span> <span class=o>/</span><span class=nx>tmp</span><span class=o>/</span><span class=nx>my</span><span class=o>-</span><span class=nx>output</span><span class=o>-</span><span class=nx>file</span><span class=p>.</span><span class=nx>txt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>let</span><span class=err>&#39;</span><span class=nx>s</span> <span class=nx>check</span> <span class=nx>the</span> <span class=nx>content</span> <span class=nx>of</span> <span class=nx>the</span> <span class=nx>file</span>
</span></span><span class=line><span class=cl><span class=nx>cat</span> <span class=o>/</span><span class=nx>tmp</span><span class=o>/</span><span class=nx>my</span><span class=o>-</span><span class=nx>output</span><span class=o>-</span><span class=nx>file</span><span class=p>.</span><span class=nx>txt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>and</span> <span class=nx>the</span> <span class=nx>output</span> <span class=nx>will</span> <span class=nx>be</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=nx>Hello</span><span class=p>,</span> <span class=nx>World</span><span class=p>!</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>NOTE:</strong> as you can see, the output was written to the <code>/tmp/my-output-file.txt</code> file.</p><h2 id=critical-points>Critical Points<a hidden class=anchor aria-hidden=true href=#critical-points>#</a></h2><p>For me ☝️ the <strong>magic</strong> 🪄 of this implementation is in the <code>Set</code> method of the <code>FileVar</code> struct. This method is called once, in command line order, for each flag present. So, in this method, I open the file with the <code>os.OpenFile</code> function and set the <code>*os.File</code> field of the <code>FileVar</code> struct with the file descriptor.</p><p>The options <code>os.O_APPEND|os.O_CREATE|os.O_WRONLY</code> are used to open the file in <code>write-only</code> mode, create it if it doesn&rsquo;t exist, and <strong>append the content</strong> if the file already exists.</p><p><strong>NOTE:</strong>, maybe you want to overwrite the file content instead of appending it, you can use the <code>os.O_TRUNC</code> option instead of the <code>os.O_APPEND</code> option.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2>2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3>3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4>4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5>5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6>6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7>7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8>8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>f</span> <span class=o>*</span><span class=nx>FileVar</span><span class=p>)</span> <span class=nf>Set</span><span class=p>(</span><span class=nx>value</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>file</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>OpenFile</span><span class=p>(</span><span class=nx>value</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>O_APPEND</span><span class=p>|</span><span class=nx>os</span><span class=p>.</span><span class=nx>O_CREATE</span><span class=p>|</span><span class=nx>os</span><span class=p>.</span><span class=nx>O_WRONLY</span><span class=p>,</span> <span class=mi>0</span><span class=nx>o644</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>f</span><span class=p>.</span><span class=nx>File</span> <span class=p>=</span> <span class=nx>file</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=implementation>Implementation<a hidden class=anchor aria-hidden=true href=#implementation>#</a></h2><p>This code is available in the <a href=https://github.com/slashdevops/go-files-as-a-flag>GitHub repository -> github.com/slashdevops/go-files-as-a-flag</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=hl><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span></span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a>
</span><span class=hl><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17>17</a>
</span></span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18>18</a>
</span><span class=lnt id=hl-5-19><a class=lnlinks href=#hl-5-19>19</a>
</span><span class=lnt id=hl-5-20><a class=lnlinks href=#hl-5-20>20</a>
</span><span class=lnt id=hl-5-21><a class=lnlinks href=#hl-5-21>21</a>
</span><span class=lnt id=hl-5-22><a class=lnlinks href=#hl-5-22>22</a>
</span><span class=lnt id=hl-5-23><a class=lnlinks href=#hl-5-23>23</a>
</span><span class=lnt id=hl-5-24><a class=lnlinks href=#hl-5-24>24</a>
</span><span class=lnt id=hl-5-25><a class=lnlinks href=#hl-5-25>25</a>
</span><span class=hl><span class=lnt id=hl-5-26><a class=lnlinks href=#hl-5-26>26</a>
</span></span><span class=lnt id=hl-5-27><a class=lnlinks href=#hl-5-27>27</a>
</span><span class=lnt id=hl-5-28><a class=lnlinks href=#hl-5-28>28</a>
</span><span class=lnt id=hl-5-29><a class=lnlinks href=#hl-5-29>29</a>
</span><span class=lnt id=hl-5-30><a class=lnlinks href=#hl-5-30>30</a>
</span><span class=lnt id=hl-5-31><a class=lnlinks href=#hl-5-31>31</a>
</span><span class=lnt id=hl-5-32><a class=lnlinks href=#hl-5-32>32</a>
</span><span class=lnt id=hl-5-33><a class=lnlinks href=#hl-5-33>33</a>
</span><span class=lnt id=hl-5-34><a class=lnlinks href=#hl-5-34>34</a>
</span><span class=lnt id=hl-5-35><a class=lnlinks href=#hl-5-35>35</a>
</span><span class=lnt id=hl-5-36><a class=lnlinks href=#hl-5-36>36</a>
</span><span class=hl><span class=lnt id=hl-5-37><a class=lnlinks href=#hl-5-37>37</a>
</span></span><span class=lnt id=hl-5-38><a class=lnlinks href=#hl-5-38>38</a>
</span><span class=lnt id=hl-5-39><a class=lnlinks href=#hl-5-39>39</a>
</span><span class=lnt id=hl-5-40><a class=lnlinks href=#hl-5-40>40</a>
</span><span class=lnt id=hl-5-41><a class=lnlinks href=#hl-5-41>41</a>
</span><span class=hl><span class=lnt id=hl-5-42><a class=lnlinks href=#hl-5-42>42</a>
</span></span><span class=lnt id=hl-5-43><a class=lnlinks href=#hl-5-43>43</a>
</span><span class=lnt id=hl-5-44><a class=lnlinks href=#hl-5-44>44</a>
</span><span class=lnt id=hl-5-45><a class=lnlinks href=#hl-5-45>45</a>
</span><span class=lnt id=hl-5-46><a class=lnlinks href=#hl-5-46>46</a>
</span><span class=lnt id=hl-5-47><a class=lnlinks href=#hl-5-47>47</a>
</span><span class=hl><span class=lnt id=hl-5-48><a class=lnlinks href=#hl-5-48>48</a>
</span></span><span class=lnt id=hl-5-49><a class=lnlinks href=#hl-5-49>49</a>
</span><span class=lnt id=hl-5-50><a class=lnlinks href=#hl-5-50>50</a>
</span><span class=lnt id=hl-5-51><a class=lnlinks href=#hl-5-51>51</a>
</span><span class=lnt id=hl-5-52><a class=lnlinks href=#hl-5-52>52</a>
</span><span class=lnt id=hl-5-53><a class=lnlinks href=#hl-5-53>53</a>
</span><span class=lnt id=hl-5-54><a class=lnlinks href=#hl-5-54>54</a>
</span><span class=lnt id=hl-5-55><a class=lnlinks href=#hl-5-55>55</a>
</span><span class=lnt id=hl-5-56><a class=lnlinks href=#hl-5-56>56</a>
</span><span class=hl><span class=lnt id=hl-5-57><a class=lnlinks href=#hl-5-57>57</a>
</span></span><span class=lnt id=hl-5-58><a class=lnlinks href=#hl-5-58>58</a>
</span><span class=lnt id=hl-5-59><a class=lnlinks href=#hl-5-59>59</a>
</span><span class=lnt id=hl-5-60><a class=lnlinks href=#hl-5-60>60</a>
</span><span class=lnt id=hl-5-61><a class=lnlinks href=#hl-5-61>61</a>
</span><span class=lnt id=hl-5-62><a class=lnlinks href=#hl-5-62>62</a>
</span><span class=lnt id=hl-5-63><a class=lnlinks href=#hl-5-63>63</a>
</span><span class=lnt id=hl-5-64><a class=lnlinks href=#hl-5-64>64</a>
</span><span class=lnt id=hl-5-65><a class=lnlinks href=#hl-5-65>65</a>
</span><span class=lnt id=hl-5-66><a class=lnlinks href=#hl-5-66>66</a>
</span><span class=lnt id=hl-5-67><a class=lnlinks href=#hl-5-67>67</a>
</span><span class=lnt id=hl-5-68><a class=lnlinks href=#hl-5-68>68</a>
</span><span class=lnt id=hl-5-69><a class=lnlinks href=#hl-5-69>69</a>
</span><span class=lnt id=hl-5-70><a class=lnlinks href=#hl-5-70>70</a>
</span><span class=lnt id=hl-5-71><a class=lnlinks href=#hl-5-71>71</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;flag&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// FileVar is a custom flag type for files
</span></span></span><span class=line><span class=cl><span class=c1>// This should implement the Value interface of the flag package
</span></span></span><span class=line><span class=cl><span class=c1>// Reference: https://pkg.go.dev/gg-scm.io/tool/internal/flag#FlagSet.Var
</span></span></span><span class="line hl"><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>FileVar</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=o>*</span><span class=nx>os</span><span class=p>.</span><span class=nx>File</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// String presents the current value as a string.
</span></span></span><span class="line hl"><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>f</span> <span class=o>*</span><span class=nx>FileVar</span><span class=p>)</span> <span class=nf>String</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>f</span><span class=p>.</span><span class=nx>File</span> <span class=o>==</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=s>&#34;&#34;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>f</span><span class=p>.</span><span class=nf>Name</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Set is called once, in command line order, for each flag present.
</span></span></span><span class="line hl"><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>f</span> <span class=o>*</span><span class=nx>FileVar</span><span class=p>)</span> <span class=nf>Set</span><span class=p>(</span><span class=nx>value</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>file</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>OpenFile</span><span class=p>(</span><span class=nx>value</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>O_APPEND</span><span class=p>|</span><span class=nx>os</span><span class=p>.</span><span class=nx>O_CREATE</span><span class=p>|</span><span class=nx>os</span><span class=p>.</span><span class=nx>O_WRONLY</span><span class=p>,</span> <span class=mi>0</span><span class=nx>o644</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>f</span><span class=p>.</span><span class=nx>File</span> <span class=p>=</span> <span class=nx>file</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Get returns the contents of the Value.
</span></span></span><span class="line hl"><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>f</span> <span class=o>*</span><span class=nx>FileVar</span><span class=p>)</span> <span class=nf>Get</span><span class=p>()</span> <span class=kd>interface</span><span class=p>{}</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>f</span><span class=p>.</span><span class=nx>File</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// IsBoolFlag returns true if the flag is a boolean flag
</span></span></span><span class="line hl"><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>f</span> <span class=o>*</span><span class=nx>FileVar</span><span class=p>)</span> <span class=nf>IsBoolFlag</span><span class=p>()</span> <span class=kt>bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>// Create a new flag set
</span></span></span><span class="line hl"><span class=cl><span class=c1></span>	<span class=nx>fs</span> <span class=o>:=</span> <span class=nx>flag</span><span class=p>.</span><span class=nf>NewFlagSet</span><span class=p>(</span><span class=s>&#34;File as Flag CLI&#34;</span><span class=p>,</span> <span class=nx>flag</span><span class=p>.</span><span class=nx>ExitOnError</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Add a flag to get some content
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=kd>var</span> <span class=nx>content</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=nx>fs</span><span class=p>.</span><span class=nf>StringVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>content</span><span class=p>,</span> <span class=s>&#34;file.content&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=s>&#34;content to write to the file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Add a custom file flag
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>file</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>FileVar</span><span class=p>{</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdout</span><span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>defer</span> <span class=nx>file</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class="line hl"><span class=cl>	<span class=nx>fs</span><span class=p>.</span><span class=nf>Var</span><span class=p>(</span><span class=nx>file</span><span class=p>,</span> <span class=s>&#34;output.file&#34;</span><span class=p>,</span> <span class=s>&#34;output file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Parse the command line arguments
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>fs</span><span class=p>.</span><span class=nf>Parse</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Args</span><span class=p>[</span><span class=mi>1</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Check if the content is empty (required)
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span> <span class=nx>content</span> <span class=o>==</span> <span class=s>&#34;&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>fs</span><span class=p>.</span><span class=nf>PrintDefaults</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;error: &#39;-file.content&#39; is required&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Write the content to the file
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>file</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>content</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>The <a href=https://pkg.go.dev/flag>flag package of the Golang</a> standard library is powerful and flexible as you saw in this post. You can create <strong>custom flag types</strong> to extend the functionality of the package and adapt it to your needs. For this you should implement the <a href=https://pkg.go.dev/gg-scm.io/tool/internal/flag#Value>Value interface</a> of the <a href=https://pkg.go.dev/gg-scm.io/tool/internal/flag>flag package</a> for the <code>struct type</code> that represents your <code>flag type</code>.</p><p>I hope this post helps you to use files as a flag in your Golang CLI applications. If you have any questions or suggestions, please let me know in the comments below. 🙏</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://slashdevops.com/tags/golang/>Golang</a></li><li><a href=https://slashdevops.com/tags/cli/>Cli</a></li><li><a href=https://slashdevops.com/tags/flag/>Flag</a></li><li><a href=https://slashdevops.com/tags/file/>File</a></li><li><a href=https://slashdevops.com/tags/go/>Go</a></li></ul><nav class=paginav><a class=next href=https://slashdevops.com/post/2024/03/31/2/building-and-debugging-a-c-project-in-visual-studio-code-with-a-makefile/><span class=title>Next »</span><br><span>Building and Debugging a C Project in Visual Studio Code with a Makefile</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Using Files as a Flag in the Golang Command Line Interface (CLI) on x" href="https://x.com/intent/tweet/?text=Using%20Files%20as%20a%20Flag%20in%20the%20Golang%20Command%20Line%20Interface%20%28CLI%29&amp;url=https%3a%2f%2fslashdevops.com%2fpost%2f2024%2f04%2f07%2f1%2fusing-files-as-a-flag-in-the-golang-command-line-interface-cli%2f&amp;hashtags=golang%2ccli%2cflag%2cfile%2cgo"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Using Files as a Flag in the Golang Command Line Interface (CLI) on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fslashdevops.com%2fpost%2f2024%2f04%2f07%2f1%2fusing-files-as-a-flag-in-the-golang-command-line-interface-cli%2f&amp;title=Using%20Files%20as%20a%20Flag%20in%20the%20Golang%20Command%20Line%20Interface%20%28CLI%29&amp;summary=Using%20Files%20as%20a%20Flag%20in%20the%20Golang%20Command%20Line%20Interface%20%28CLI%29&amp;source=https%3a%2f%2fslashdevops.com%2fpost%2f2024%2f04%2f07%2f1%2fusing-files-as-a-flag-in-the-golang-command-line-interface-cli%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Using Files as a Flag in the Golang Command Line Interface (CLI) on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fslashdevops.com%2fpost%2f2024%2f04%2f07%2f1%2fusing-files-as-a-flag-in-the-golang-command-line-interface-cli%2f&title=Using%20Files%20as%20a%20Flag%20in%20the%20Golang%20Command%20Line%20Interface%20%28CLI%29"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Using Files as a Flag in the Golang Command Line Interface (CLI) on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fslashdevops.com%2fpost%2f2024%2f04%2f07%2f1%2fusing-files-as-a-flag-in-the-golang-command-line-interface-cli%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Using Files as a Flag in the Golang Command Line Interface (CLI) on whatsapp" href="https://api.whatsapp.com/send?text=Using%20Files%20as%20a%20Flag%20in%20the%20Golang%20Command%20Line%20Interface%20%28CLI%29%20-%20https%3a%2f%2fslashdevops.com%2fpost%2f2024%2f04%2f07%2f1%2fusing-files-as-a-flag-in-the-golang-command-line-interface-cli%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Using Files as a Flag in the Golang Command Line Interface (CLI) on telegram" href="https://telegram.me/share/url?text=Using%20Files%20as%20a%20Flag%20in%20the%20Golang%20Command%20Line%20Interface%20%28CLI%29&amp;url=https%3a%2f%2fslashdevops.com%2fpost%2f2024%2f04%2f07%2f1%2fusing-files-as-a-flag-in-the-golang-command-line-interface-cli%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Using Files as a Flag in the Golang Command Line Interface (CLI) on ycombinator" href="https://news.ycombinator.com/submitlink?t=Using%20Files%20as%20a%20Flag%20in%20the%20Golang%20Command%20Line%20Interface%20%28CLI%29&u=https%3a%2f%2fslashdevops.com%2fpost%2f2024%2f04%2f07%2f1%2fusing-files-as-a-flag-in-the-golang-command-line-interface-cli%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//https-slashdevops-com.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2024 <a href=https://slashdevops.com/>SlashDevOps</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>